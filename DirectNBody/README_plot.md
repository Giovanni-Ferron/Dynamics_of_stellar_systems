# readAndPlot

### Python script to plot halo density and velocity profiles from the .hdf5 file generated by the GetHaloDensityProfile.py script. A NFW fit of the 3D mass profile is also performed.
&nbsp;

## **Execution of the plotting routine**

The script is executed with the following command (with some example values):

    python readAndPlot.py -i halo00037.0 -s True

With the following options:

* **-i** &emsp; &emsp; &nbsp;&emsp; \[string\] Input file name
* **-s** &emsp; &emsp; &nbsp; &emsp;\[string\] Save plots in the folder "Figures"
* **-p** &emsp; &emsp; &nbsp;&emsp;\[string\] Show the plots during execution. Default = False
&nbsp;

## **General functioning**
For every halo within the .hdf5 file generated by GetHaloDensityProfile.py, the script reads all relevant, 3D and projected, binned quantities (halo mass, cumulative mass, mass density, velocity dispersion, $r_{500}$, $r_{200}$ and the particles mass weighted radii). 
From the velocity dispersions the velocity anisotropy is computed and four plots are generated. These contain the 3D density profile (upper left), the three (2D) projected density profiles divided by the critical density (upper right), the velocity dispersion profiles (lower left) and the anisotropy profile $\beta (r)$ (lower right).

The script further produces a NFW fit of the 3D cumulative mass profile, saving the values of $r_{200}$, $r_s$, $M_{500}$ and $C_{500}$. The plot is saved in the "Figures" folder.

**All plotted radii are in units of $r_{500}$, and all densities are in $M_\odot / Mpc^3$.**

&nbsp;

## **Functions definitions**

* ### ***M_nfw*** *(r, lr2, lrs, z, h, Om, Ol)*

    NFW function for fitting.

    #### **Args:**
    - **r:** *\[float\]*

        Radius in Mpc.

    - **lr2:** *\[float\]*
    
        Logarithm of $r_{200}$/Mpc.
    
    - **lrs:** *\[float\]*

        Logarithm of $r_s$/Mpc.

    - **z:** *\[float\]*
            
        Redshift.

    - **h:** *\[float\]*

        Reduced hubble constant.

    - **Om:** *\[float\]*

        Omega Matter.

    - **Ol:** *\[float\]*

        Omega Lambda.

    #### **Returns:**

    - **nfw:** *\[float\]*

        NFW profile at a given radius.